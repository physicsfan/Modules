MODULE mtjj
!*******************************************************************
!                                                                  *  
!   This MODULE groups together the subroutines in the series      *
!   gg1112 - gg1234, rather than relying on calls to the           *
!   subroutines in separate files.                                 *
!                                                                  *   
!                                                                  *
!   SUBROUTINES written by  G. Gaigalas                            *
!   Transform to fortran 90/95 by G. Gaigalas       December 2012  *
!   The last modification made by G. Gaigalas       October  2017  *
!   MODULE created by A. Senchuk                    February 2020  *  
!                                                                  *
!*******************************************************************

  IMPLICIT NONE

  INTEGER, DIMENSION(63) :: MT
  DATA MT/00201,10000,10203,20000,00404,20205,00603,00609,30000, &
       10404,10408,10603,10605,30207,10609,10611,10615,40000,20404,   &
       00804,20408,00808,00810,20412,00816,                           &
       00001001,00020603,00020605,00001005,00020607,00001007,         &
       00040209,00020609,00001009,00020611,00001011,00020613,00001013,&
       00020615,00001015,00020617,00001017,00001019,00020621,00001025,&
       00050000,00010800,00030404,00010804,00010806,00030408,         &
       01010808,02010808,00010810,00030412,01010812,02010812,00010814,&
       00030416,00010816,00010818,00010820,00010824/


  INTEGER, DIMENSION(6)   :: MT9
  INTEGER, DIMENSION(189) :: MT11
  DATA MT9/40209,50000,30404,30408,30412,30416/
  DATA MT11/50211,                                              &
       60000,40404,40408,40412,40416,40420,                          &
       60213,                                                        &
       70000,50404,50408,50412,50416,50420,50424,                    &
       70215,                                                        &
       80000,60404,60408,60412,60416,60420,60424,60428,              &
       80217,                                                        &
       90000,70404,70408,70412,70416,70420,70424,70428,70432,        &
       90219,                                                        &
       100000,80404,80408,80412,80416,80420,80424,80428,80432,80436, &
       100221,                                                       &
       110000,90404,90408,90412,90416,90420,90424,90428,90432,90436, &
       90440,                                                        &
       110223,                                                       &
       120000,100404,100408,100412,100416,100420,100424,100428,      &
       100432,100436,100440,100444,                                  &
       120225,                                                       &
       130000,110404,110408,110412,110416,110420,110424,110428,      &
       110432,110436,110440,110444,110448,                           &
       130227,                                                       &
       140000,120404,120408,120412,120416,120420,120424,120428,      &
       120432,120436,120440,120444,120448,120452,                    &
       140229,                                                       &
       150000,130404,130408,130412,130416,130420,130424,130428,      &
       130432,130436,130440,130444,130448,130452,130456,             &
       150231,                                                       &
       160000,140404,140408,140412,140416,140420,140424,140428,      &
       140432,140436,140440,140444,140448,140452,140456,140460,      &
       160233,                                                       &
       170000,150404,150408,150412,150416,150420,150424,150428,      &
       150432,150436,150440,150444,150448,150452,150456,150460,      &
       150464,                                                       &
       170235,                                                       &
       180000,160404,160408,160412,160416,160420,160424,160428,      &
       160432,160436,160440,160444,160448,160452,160456,160460,      &
       160464,160468,                                                &
       180237,                                                       &
       190000,170404,170408,170412,170416,170420,170424,170428,      &
       170432,170436,170440,170444,170448,170452,170456,170460,      &
       170464,170468,170472/


CONTAINS


  !*******************************************************************
  !                                                                  *
  INTEGER FUNCTION JTHN(K,N,I)
    !                                                                  *
    !   Written by G. Gaigalas,                                        * 
    !   Vanderbilt University,  Nashville               October  1996  *
    !   The last modification made by G. Gaigalas       October  2017  *
    !                                                                  *
    !******************************************************************* 

    IMPLICIT NONE
    !-----------------------------------------------
    !   D u m m y   A r g u m e n t s
    !-----------------------------------------------
    INTEGER, INTENT(IN) :: I, N, K
    !-----------------------------------------------
    IF(N == 1) THEN
       JTHN=MOD(K,I)
    ELSEIF(N == 2) THEN
       JTHN=MOD(K/I,I)
    ELSEIF(N == 3) THEN
       JTHN=MOD(K/(I*I),I)
    ELSEIF(N == 4) THEN
       JTHN=MOD(K/(I*I*I),I)
    ELSEIF(N == 5) THEN
       JTHN=MOD(K/(I*I*I*I),I)
    ELSE
       WRITE(6,'(A)') ' ERROR IN JTHN '
       STOP
    ENDIF
    RETURN
  END FUNCTION JTHN


  !*******************************************************************
  !                                                                  *
  INTEGER FUNCTION NMTEJJ(I2Q,I2J,J,NK,ND)
    !                                                                  *
    !     ------------  SECTION METWO    SUBPROGRAM 21  -------------  *
    !                                                                  *
    !                                                                  *
    !   Written by  G. Gaigalas                                        *
    !   The last modification made by G. Gaigalas       October  2017  *
    !                                                                  *
    !                                                                  *
    !*******************************************************************
    !
    IMPLICIT NONE
    !-----------------------------------------------
    !   D u m m y   A r g u m e n t s
    !-----------------------------------------------
    INTEGER, INTENT(IN) :: I2Q, I2J, J, NK, ND
    !      DIMENSION LP(9),LG(9),LP3(27),LG3(27)
    !-----------------------------------------------
    !   L o c a l   V a r i a b l e s
    !-----------------------------------------------
    INTEGER                :: I2V, INN, IL, JP, JG, JJ
    INTEGER, DIMENSION(9)  :: LP, LG
    INTEGER, DIMENSION(27) :: LP3, LG3
    !-----------------------------------------------
    DATA LP/1,0,3,0,6,0,12,0,26/
    DATA LG/2,0,5,0,11,0,25,0,63/
    DATA LP3/1,0,8,0,16,0,25,0,35,0,46,0,58,0,71,0,85,0,100,0, &
         116,0,133,0,151,0,170/
    DATA LG3/7,0,15,0,24,0,34,0,45,0,57,0,70,0,84,0,99,0,115,0,&
         132,0,150,0,169,0,189/
    NMTEJJ=0
    IF(J > 37)RETURN
    I2V=J+1-2*I2Q
    INN=(I2Q*100+I2V)*100+I2J
    IF(J < 9) THEN
       JP=LP(J)
       IF(JP == 0)RETURN
       JG=LG(J)
       IF(JG == 0)RETURN
       JJ=JP
2      IF(INN-MT(JJ))3,1,3
3      JJ=JJ+1
       IF(JJ > JG)RETURN
       GO TO 2
1      NMTEJJ=JJ
    ELSEIF(J == 9) THEN
       IF(MAX0(NK,ND) < 3) THEN
          JP=1
          JG=6
          JJ=JP
6         IF(INN-MT9(JJ))4,5,4
4         JJ=JJ+1
          IF(JJ > JG)RETURN
          GO TO 6
5         NMTEJJ=JJ+300
       ELSE
          PRINT*, "ERROR in FUNCTION NMTEJJ"
          STOP
       END IF
    ELSE
       IL=J-10
       JP=LP3(IL)
       JG=LG3(IL)
       JJ=JP
22     IF(INN-MT11(JJ))23,21,23
23     JJ=JJ+1
       IF(JJ > JG)RETURN
       GO TO 22
21     NMTEJJ=JJ
    ENDIF
    RETURN
  END FUNCTION NMTEJJ



  !*******************************************************************
  !                                                                  *
  SUBROUTINE RUMTJJ(KNT,JJ,LQ,LV,L)
    !                                                                  *
    !   ---------------  SECTION SQJJ  SUBPROGRAM 16  --------------   *
    !                                                                  *
    !                                                                  *
    !   Written by  G. Gaigalas                                        *
    !   The last modification made by G. Gaigalas       October  2017  *
    !                                                                  *
    !*******************************************************************
    !
    IMPLICIT NONE
    !-----------------------------------------------
    !   D u m m y   A r g u m e n t s
    !-----------------------------------------------
    INTEGER, INTENT(IN)  :: JJ, KNT
    INTEGER, INTENT(OUT) :: LQ, LV, L
    !-----------------------------------------------
    !   L o c a l   V a r i a b l e s
    !-----------------------------------------------
    INTEGER :: KT, KNTMIN
    !-----------------------------------------------

    IF(JJ < 9) THEN
       KT=MT(KNT)
    ELSE IF(JJ == 9) THEN
       IF(KNT > 300) THEN
          KNTMIN=KNT-300
          KT=MT9(KNTMIN)
       ELSE
          PRINT*, "ERROR in RUMTJJ"
          STOP
       ENDIF
    ELSE
       KT=MT11(KNT)
    ENDIF
    LQ=JTHN(KT,3,100)
    LV=JTHN(KT,2,100)
    L=JTHN(KT,1,100)
    RETURN
  END SUBROUTINE RUMTJJ


END MODULE mtjj
